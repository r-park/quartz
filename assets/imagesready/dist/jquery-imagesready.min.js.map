{"version":3,"sources":["jquery-imagesready.min.js"],"names":["root","factory","define","amd","exports","module","imagesReady","this","defer","deferred","promise","Promise","resolve","reject","ImagesReady","elements","options","document","querySelectorAll","providedElements","toArray","images","findImageElements","jquery","$","Deferred","result","total","length","loaded","verified","auto","verify","instance","slice","Array","prototype","validNodeTypes",1,9,11,"element","imageElements","i","nodeName","push","nodeType","n","l","update","clean","image","complete","naturalWidth","verifyByProxy","src","imageSrc","Image","that","cleanup","removeEventListener","onload","onerror","addEventListener","object","isArray","call","window","jQuery","fn"],"mappings":"CAAC,SAASA,EAAMC,GACQ,kBAAXC,SAAyBA,OAAOC,IACzCD,UAAWD,GACiB,gBAAZG,SAChBC,OAAOD,QAAUH,IAEjBD,EAAKM,YAAcL,KAErBM,KAAM,WACR,YAYA,SAASC,KACP,GAAIC,KAKJ,OAJAA,GAASC,QAAU,GAAIC,SAAQ,SAASC,EAASC,GAC/CJ,EAASG,QAAUA,EACnBH,EAASI,OAASA,IAEbJ,EAeT,QAASK,GAAYC,EAAUC,GAC7BA,EAAUA,MAEc,gBAAbD,KACTA,EAAWE,SAASC,iBAAiBH,IAGvCR,KAAKY,iBAAmBJ,EACxBR,KAAKQ,SAAWR,KAAKa,QAAQL,GAC7BR,KAAKc,OAASd,KAAKe,kBAAkBf,KAAKQ,UAEtCC,GAAWA,EAAQO,QACrBhB,KAAKE,SAAW,GAAIe,GAAEC,SACtBlB,KAAKmB,OAASnB,KAAKE,SAASC,YAG5BH,KAAKE,SAAWD,IAChBD,KAAKmB,OAASnB,KAAKE,SAASC,SAG9BH,KAAKoB,MAAQpB,KAAKc,OAAOO,OACzBrB,KAAKsB,OAAS,EACdtB,KAAKuB,SAAW,EAEZd,EAAQe,QAAS,GACnBxB,KAAKyB,SAkJT,QAAS1B,GAAYS,GACnB,GAAIkB,GAAW,GAAInB,GAAYC,EAC/B,OAAOkB,GAASP,OA3MlB,GAAIQ,GAAQC,MAAMC,UAAUF,MAExBG,GACFC,GAAK,EACLC,GAAK,EACLC,IAAK,EAyMP,OAjJA1B,GAAYsB,WAMVd,kBAAoB,SAASP,GAM3B,IALA,GAEI0B,GACAC,EAHArB,KACAsB,EAAI5B,EAASa,OAIVe,KAGL,GAFAF,EAAU1B,EAAS4B,GAEM,QAArBF,EAAQG,SACVvB,EAAOwB,KAAKJ,OAET,IAAIA,EAAQK,UAAYT,EAAeI,EAAQK,UAAW,CAC7DJ,EAAgBD,EAAQvB,iBAAiB,MACzC,KAAK,GAAI6B,GAAI,EAAGC,EAAIN,EAAcd,OAAYoB,EAAJD,IAASA,EACjD1B,EAAOwB,KAAKH,EAAcK,IAKhC,MAAO1B,IAOT4B,OAAS,WACP1C,KAAKuB,WAEDvB,KAAKoB,QAAUpB,KAAKuB,WAClBvB,KAAKoB,QAAUpB,KAAKsB,OACtBtB,KAAKE,SAASG,QAAQL,KAAKY,kBAG3BZ,KAAKE,SAASI,OAAO,QAGvBN,KAAK2C,UAQTlB,OAAS,WAMP,IALA,GAGImB,GAHA9B,EAASd,KAAKc,OACdsB,EAAI,GACJK,EAAI3B,EAAOO,SAGNe,EAAIK,GACXG,EAAQ9B,EAAOsB,GAEXQ,EAAMC,UAAYD,EAAME,cAC1B9C,KAAKsB,SACLtB,KAAK0C,UAGL1C,KAAK+C,cAAcH,EAAMI,MAS/BD,cAAgB,SAASE,GACvB,GAAIL,GAAQ,GAAIM,OACZC,EAAOnD,KAEPoD,EAAU,WACZR,EAAMS,oBAAoB,OAAQC,QAClCV,EAAMS,oBAAoB,OAAQE,SAClCX,EAAQ,KAGVA,GAAMY,iBAAiB,OAAQ,WAC7BL,EAAK7B,SACL6B,EAAKT,SACLU,MAGFR,EAAMY,iBAAiB,QAAS,WAC9BL,EAAKT,SACLU,MAGFR,EAAMI,IAAMC,GAOdN,MAAQ,WACN3C,KAAKQ,SAAW,KAChBR,KAAKc,OAAS,MAQhBD,QAAU,SAAS4C,GACjB,MAAI7B,OAAM8B,QAAQD,GAAgBA,EAEL,gBAAlBA,GAAOpC,OACTM,EAAMgC,KAAKF,IAGZA,KASRG,OAAOC,SACT5C,EAAE6C,GAAG/D,YAAc,WACjB,GAAI2B,GAAW,GAAInB,GAAYP,MAAOgB,QAAQ,GAC9C,OAAOU,GAASP,SAabpB","file":"jquery-imagesready.min.js","sourcesContent":["(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.imagesReady = factory();\n  }\n}(this, function() {\n'use strict';\n\n\nvar slice = Array.prototype.slice;\n\nvar validNodeTypes = {\n  1  : true, // ELEMENT_NODE\n  9  : true, // DOCUMENT_NODE\n  11 : true  // DOCUMENT_FRAGMENT_NODE\n};\n\n\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function(resolve, reject){\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n\n/**\n * @name ImagesReady\n * @constructor\n *\n * @param {DocumentFragment|Element|Element[]|jQuery|NodeList|string} elements\n *\n * @param {{}}      [options]\n * @param {boolean} [options.auto]\n * @param {boolean} [options.jquery]\n *\n */\nfunction ImagesReady(elements, options) {\n  options = options || {};\n\n  if (typeof elements === 'string') {\n    elements = document.querySelectorAll(elements);\n  }\n\n  this.providedElements = elements;\n  this.elements = this.toArray(elements);\n  this.images = this.findImageElements(this.elements);\n\n  if (options && options.jquery) {\n    this.deferred = new $.Deferred();\n    this.result = this.deferred.promise();\n  }\n  else {\n    this.deferred = defer();\n    this.result = this.deferred.promise;\n  }\n\n  this.total = this.images.length;\n  this.loaded = 0;\n  this.verified = 0;\n\n  if (options.auto !== false) {\n    this.verify();\n  }\n}\n\n\n\nImagesReady.prototype = {\n\n  /**\n   * @param {Element[]} elements\n   * @returns {HTMLImageElement[]}\n   */\n  findImageElements : function(elements) {\n    var images = [],\n        i = elements.length,\n        element,\n        imageElements;\n\n    while (i--) {\n      element = elements[i];\n\n      if (element.nodeName === 'IMG') {\n        images.push(element);\n      }\n      else if (element.nodeType && validNodeTypes[element.nodeType]) {\n        imageElements = element.querySelectorAll('img');\n        for (var n = 0, l = imageElements.length; n < l; ++n) {\n          images.push(imageElements[n]);\n        }\n      }\n    }\n\n    return images;\n  },\n\n\n  /**\n   *\n   */\n  update : function() {\n    this.verified++;\n\n    if (this.total === this.verified) {\n      if (this.total === this.loaded) {\n        this.deferred.resolve(this.providedElements);\n      }\n      else {\n        this.deferred.reject('FAIL');\n      }\n\n      this.clean();\n    }\n  },\n\n\n  /**\n   *\n   */\n  verify : function() {\n    var images = this.images,\n        i = -1,\n        l = images.length,\n        image;\n\n    while (++i < l) {\n      image = images[i];\n\n      if (image.complete && image.naturalWidth) {\n        this.loaded++;\n        this.update();\n      }\n      else {\n        this.verifyByProxy(image.src);\n      }\n    }\n  },\n\n\n  /**\n   * @param {string} imageSrc\n   */\n  verifyByProxy : function(imageSrc) {\n    var image = new Image(),\n        that = this;\n\n    var cleanup = function() {\n      image.removeEventListener('load', onload);\n      image.removeEventListener('load', onerror);\n      image = null;\n    };\n\n    image.addEventListener('load', function onload(){\n      that.loaded++;\n      that.update();\n      cleanup();\n    });\n\n    image.addEventListener('error', function onerror(){\n      that.update();\n      cleanup();\n    });\n\n    image.src = imageSrc;\n  },\n\n\n  /**\n   *\n   */\n  clean : function() {\n    this.elements = null;\n    this.images = null;\n  },\n\n\n  /**\n   * {Element|Element[]|NodeList} object\n   * @returns {Element[]}\n   */\n  toArray : function(object) {\n    if (Array.isArray(object)) return object;\n\n    if (typeof object.length === 'number') {\n      return slice.call(object);\n    }\n\n    return [object];\n  }\n\n};\n\n\n/*=========================================================\n  jQuery plugin\n=========================================================*/\nif (window.jQuery) {\n  $.fn.imagesReady = function() {\n    var instance = new ImagesReady(this, {jquery: true}); // eslint-disable-line no-shadow\n    return instance.result;\n  };\n}\n\n\n/*=========================================================\n  Default entry point\n=========================================================*/\nfunction imagesReady(elements) { // eslint-disable-line no-unused-vars\n  var instance = new ImagesReady(elements);\n  return instance.result;\n}\n\nreturn imagesReady;\n}));\n"],"sourceRoot":"/source/"}